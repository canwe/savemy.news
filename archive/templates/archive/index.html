{% extends "archive/base.html" %}

{% block title %}Save My News{% endblock %}

{% block content %}
<article>
    <header>
        <h1>Save My News</h1>
        <p>A personal, permanent clipping service from <a href="http://www.pastpages.org">PastPages</a> and <a href="http://archive.org">The Internet Archive</a>.</p>
    </header>
    {% if not user.is_authenticated %}
    <section>
        <p>Sign in with <a href="{% url "social:begin" "twitter" %}?next={{ request.path }}">Twitter</a> and start saving your work.</p>
    </section>
    {% else %}
    <section>
        <p>Hello, {{ user }}. (<a href="{% url "logout" %}?next={{ request.path }}">Logout</a>)</p>
        <form action="{% url 'save' %}" method="POST">
            {% csrf_token %}
            <div class="form-group row">
              <div class="col-5">
                <input class="form-control" type="url" placeholder="http://www.yoursite/news.html" value="" name="url">
              </div>
              <div class="col-2">
                  <button type="submit" class="btn btn-primary">Save</button>
              </div>
            </div>
        </form>
        {% if clip_list %}
            <table class="table table-sm">
                <thead>
                  <tr>
                    <th>URL</th>
                    <th>Archive time</th>
                    <th>Archive URL</th>
                  </tr>
                </thead>
                <tbody>
                {% for obj in clip_list %}
                    <tr>
                        <td>{{ obj.url|urlize }}</td>
                        <td>{{ obj.memento.timestamp }}</td>
                        <td>{{ obj.memento.url|urlizetrunc:30    }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </section>
    {% endif %}
</article>
{% endblock %}
